import{j as e}from"./radix-ui-core-CVbt7vjv.js";import{j as S,h as _,c as r}from"./react-vendor-CF8XAmli.js";import{C as u,w as $,d as P,Z as C,n as D,u as M,c as F,o as p,r as I,x as A,t as O}from"./other-ui-8Y7Mtx8D.js";import{s as H}from"./store-CtWTswGK.js";import{S as E,c as L,t as R}from"./index-SAJX4igD.js";import"./supabase-vendor-D5o4eRXO.js";import"./motion-vendor-gX53-bda.js";function Z(){const{id:l}=S(),d=_(),[s,b]=r.useState(null),[j,m]=r.useState(!0),[x,f]=r.useState(null),[g,c]=r.useState(0),[i,o]=r.useState(1),[h,N]=r.useState(!1);r.useEffect(()=>{(async()=>{if(l)try{m(!0);const t=await H.getById(l);b(t),t&&L(t.id,t.name)}catch(t){console.error("Error fetching product:",t),f("Gagal memuat produk. Silakan coba lagi.")}finally{m(!1)}})()},[l]);const n=a=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(a),y=()=>{if(!s)return;R(`Product Detail - ${s.name}`);const a=s.discount_price||s.price,t=`Halo, saya tertarik dengan produk ini:

*${s.name}*
Harga: ${n(a)}
Jumlah: ${i} unit

Apakah masih tersedia?`,w="6285283151990",k=encodeURIComponent(t);window.open(`https://wa.me/${w}?text=${k}`,"_blank")},v=()=>{s&&(navigator.share?navigator.share({title:s.name,text:`Lihat ${s.name} - ${n(s.discount_price||s.price)}`,url:window.location.href}):(navigator.clipboard.writeText(window.location.href),O.success("Link berhasil disalin!")))};return j?e.jsx("div",{className:"min-h-screen bg-gray-50 pt-20 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"inline-block w-8 h-8 border-4 border-green-500/30 border-t-green-500 rounded-full animate-spin mb-4"}),e.jsx("p",{className:"text-gray-500",children:"Memuat detail produk..."})]})}):x||!s?e.jsx("div",{className:"min-h-screen bg-gray-50 pt-20 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Produk Tidak Ditemukan"}),e.jsx("p",{className:"text-gray-600 mb-6",children:x||"Produk yang Anda cari mungkin sudah dihapus atau tidak tersedia."}),e.jsx("button",{onClick:()=>d("/store"),className:"px-6 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors",children:"Kembali ke Store"})]})}):e.jsxs("div",{className:"min-h-screen bg-gray-50 pt-16",children:[e.jsx(E,{title:`${s.name} - Lapak Android`,description:`${s.description.substring(0,155)}...`,keywords:`${s.name}, ${s.category}, ${s.condition}, handphone second, hp bekas, jual beli hp`,canonicalUrl:`/product/${s.id}`,ogType:"product",ogImage:s.images&&s.images.length>0?s.images[0]:void 0}),e.jsx("div",{className:"bg-white border-b",children:e.jsx("div",{className:"container mx-auto px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsxs("button",{onClick:()=>d("/store"),className:"hover:text-green-600 flex items-center gap-1",children:[e.jsx(u,{className:"h-4 w-4"}),"Kembali ke Store"]}),e.jsx("span",{children:"/"}),e.jsx("span",{className:"text-gray-900",children:s.name})]})})}),e.jsx("div",{className:"container mx-auto px-4 py-6",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2",children:[e.jsxs("div",{className:"bg-white rounded-lg p-6 mb-4",children:[e.jsxs("div",{className:"relative aspect-square bg-gray-100 rounded-lg overflow-hidden mb-4 group",children:[s.images&&s.images.length>0?e.jsx("img",{src:s.images[g],alt:s.name,className:`w-full h-full object-cover ${s.stock_status==="sold_out"?"opacity-50 grayscale":""}`}):e.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-400",children:e.jsx($,{className:"h-24 w-24"})}),s.stock_status==="sold_out"&&e.jsx("div",{className:"absolute inset-0 bg-black/60 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"bg-red-500 text-white px-8 py-4 rounded-lg font-bold text-2xl transform rotate-[-15deg] shadow-2xl",children:"SOLD OUT"}),e.jsx("p",{className:"text-white text-lg mt-3 font-medium",children:"Stok Habis"})]})}),s.images&&s.images.length>1&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:a=>{a.stopPropagation(),c(t=>t===0?s.images.length-1:t-1)},className:"absolute left-4 top-1/2 -translate-y-1/2 p-2 bg-white/80 rounded-full opacity-0 group-hover:opacity-100 transition-opacity hover:bg-white shadow-md",children:e.jsx(u,{className:"h-6 w-6 text-gray-800"})}),e.jsx("button",{onClick:a=>{a.stopPropagation(),c(t=>t===s.images.length-1?0:t+1)},className:"absolute right-4 top-1/2 -translate-y-1/2 p-2 bg-white/80 rounded-full opacity-0 group-hover:opacity-100 transition-opacity hover:bg-white shadow-md",children:e.jsx(P,{className:"h-6 w-6 text-gray-800"})})]})]}),s.images&&s.images.length>1&&e.jsx("div",{className:"relative",children:e.jsx("div",{className:"flex gap-3 overflow-x-auto pb-2 scrollbar-hide snap-x",children:s.images.map((a,t)=>e.jsx("button",{onClick:()=>c(t),className:`flex-shrink-0 w-20 h-20 rounded-lg overflow-hidden border-2 transition-all snap-start ${g===t?"border-green-500 ring-2 ring-green-500 ring-offset-2":"border-gray-200 hover:border-gray-300 opacity-70 hover:opacity-100"}`,children:e.jsx("img",{src:a,alt:`${s.name} ${t+1}`,className:"w-full h-full object-cover"})},t))})})]}),e.jsxs("div",{className:"bg-white rounded-lg p-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Detail Produk"}),e.jsx("div",{className:"prose prose-sm max-w-none",children:e.jsx("div",{className:"whitespace-pre-line text-gray-700",children:s.description})})]})]}),e.jsx("div",{className:"lg:col-span-1",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 sticky top-24",children:[e.jsx("h1",{className:"text-2xl font-bold mb-2",children:s.name}),e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsx("div",{className:"flex items-center gap-1",children:s.stock_status==="sold_out"&&e.jsx("span",{className:"px-3 py-1 bg-red-500 text-white text-sm font-bold rounded-full",children:"Sold Out"})}),e.jsx("span",{className:"text-gray-400",children:"|"}),e.jsxs("span",{className:"text-gray-600 text-sm",children:[s.sold_count||0," terjual"]})]}),e.jsx("div",{className:"mb-6",children:s.discount_price&&s.discount_price>0?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("span",{className:"px-3 py-1 bg-green-500/10 text-green-600 rounded-lg text-sm font-medium",children:"PROMO"}),e.jsx("div",{className:"text-3xl font-bold text-green-600",children:n(s.discount_price)})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"px-3 py-1 bg-gray-500/10 text-gray-600 rounded-lg text-sm font-medium",children:"Harga Asli"}),e.jsx("span",{className:"text-lg text-gray-400 line-through",children:n(s.price)}),e.jsxs("span",{className:"px-2 py-0.5 bg-green-100 text-green-600 text-xs font-bold rounded",children:[Math.round((1-s.discount_price/s.price)*100),"% OFF"]})]})]}):e.jsx("div",{className:"text-3xl font-bold text-gray-900 mb-1",children:n(s.price)})}),e.jsxs("div",{className:"flex flex-wrap gap-2 mb-6",children:[s.is_rooted&&e.jsxs("span",{className:"px-3 py-1 bg-green-100 text-green-700 text-sm font-medium rounded-full flex items-center gap-1",children:[e.jsx(C,{className:"h-4 w-4"}),"Rooted"]}),s.stock_status==="low_stock"&&e.jsx("span",{className:"px-3 py-1 bg-orange-500 text-white text-sm font-medium rounded-full",children:"Stok Terbatas"}),e.jsx("span",{className:"px-3 py-1 bg-purple-100 text-purple-700 text-sm font-medium rounded-full",children:s.condition}),e.jsx("span",{className:"px-3 py-1 bg-blue-100 text-blue-700 text-sm font-medium rounded-full",children:s.category})]}),e.jsxs("div",{className:"space-y-3 mb-6 pb-6 border-b",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(D,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{className:"text-gray-600",children:"Dikirim dari:"}),e.jsx("span",{className:"font-medium",children:s.location})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(M,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{className:"text-gray-600",children:"Stok:"}),s.stock_status==="sold_out"?e.jsx("span",{className:"font-medium text-red-600",children:"Habis"}):e.jsxs("span",{className:`font-medium ${s.stock<=3?"text-orange-600":"text-green-600"}`,children:[s.stock," unit tersisa"]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(F,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{className:"text-gray-600",children:"Garansi:"}),e.jsx("span",{className:"font-medium",children:"Garansi Toko"})]})]}),s.stock_status!=="sold_out"&&e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Jumlah"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>o(Math.max(1,i-1)),className:"w-10 h-10 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"-"}),e.jsx("input",{type:"number",value:i,onChange:a=>o(Math.max(1,Math.min(s.stock,Number(a.target.value)))),className:"w-20 h-10 text-center border border-gray-300 rounded-lg focus:outline-none focus:border-green-500"}),e.jsx("button",{onClick:()=>o(Math.min(s.stock,i+1)),className:"w-10 h-10 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"+"})]})]}),e.jsxs("div",{className:"space-y-3 mb-6",children:[s.stock_status==="sold_out"?e.jsxs("button",{disabled:!0,className:"w-full py-3 bg-gray-400 text-white rounded-lg cursor-not-allowed font-medium flex items-center justify-center gap-2",children:[e.jsx(p,{className:"h-5 w-5"}),"Stok Habis"]}):e.jsxs("button",{onClick:y,className:"w-full py-3 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors font-medium flex items-center justify-center gap-2",children:[e.jsx(p,{className:"h-5 w-5"}),"Pesan via WhatsApp"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("button",{onClick:()=>N(!h),className:"py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors flex items-center justify-center gap-2",children:[e.jsx(I,{className:`h-5 w-5 ${h?"fill-red-500 text-red-500":"text-gray-600"}`}),e.jsx("span",{className:"text-sm",children:"Wishlist"})]}),e.jsxs("button",{onClick:v,className:"py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors flex items-center justify-center gap-2",children:[e.jsx(A,{className:"h-5 w-5 text-gray-600"}),e.jsx("span",{className:"text-sm",children:"Share"})]})]})]})]})})]})})]})}export{Z as ProductDetailPage};
