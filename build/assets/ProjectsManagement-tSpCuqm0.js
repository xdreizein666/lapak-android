import{j as e}from"./radix-ui-core-CVbt7vjv.js";import{c as m,h as S}from"./react-vendor-CF8XAmli.js";import{X as O,a0 as A,a1 as B,s as L,a2 as N,p as M,a3 as T,a4 as E,t as x}from"./other-ui-8Y7Mtx8D.js";import{u as _}from"./useProjects-C9X-KmBX.js";import{I as D}from"./ImageUploader-D3ZS0H5I.js";import{A as K,m as c}from"./index-SAJX4igD.js";import"./supabase-vendor-D5o4eRXO.js";import"./motion-vendor-gX53-bda.js";function R({isOpen:u,onClose:l,onSubmit:j,project:r,mode:d}){const[a,i]=m.useState({title:"",brand:"",category:"",description:"",image_url:"",status:"ongoing"}),[h,p]=m.useState(!1);m.useEffect(()=>{i(d==="edit"&&r?{title:r.title,brand:r.brand,category:r.category,description:r.description,image_url:r.image_url||"",status:r.status}:{title:"",brand:"",category:"",description:"",image_url:"",status:"ongoing"})},[d,r,u]);const f=async t=>{t.preventDefault(),p(!0);try{await j(a),l()}catch(g){console.error("Error submitting project:",g)}finally{p(!1)}},y=["Xiaomi","Samsung","Oppo","Vivo","Realme","Google","OnePlus","Asus","Lainnya"],o=["Root Android","Custom ROM","Unlock Bootloader","Aplikasi","Lainnya"];return e.jsx(K,{children:u&&e.jsxs(e.Fragment,{children:[e.jsx(c.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:l,className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50"}),e.jsx("div",{className:"fixed inset-0 flex items-center justify-center z-50 p-4",children:e.jsxs(c.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},className:"bg-card rounded-xl shadow-2xl border border-border w-full max-w-xl max-h-[90vh] overflow-hidden flex flex-col",onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-border flex-shrink-0",children:[e.jsx("h3",{children:d==="create"?"Tambah Project":"Edit Project"}),e.jsx("button",{onClick:l,className:"p-1.5 hover:bg-muted rounded-lg transition-colors",children:e.jsx(O,{className:"h-4 w-4"})})]}),e.jsxs("form",{onSubmit:f,className:"overflow-y-auto flex-1",children:[e.jsxs("div",{className:"p-4 space-y-3",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm mb-1.5",children:["Judul Project ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:a.title,onChange:t=>i({...a,title:t.target.value}),placeholder:"Root Xiaomi Redmi Note 12 Pro",required:!0,className:"w-full px-3 py-2 text-sm bg-background border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm mb-1.5",children:["Brand ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:a.brand,onChange:t=>i({...a,brand:t.target.value}),required:!0,className:"w-full px-3 py-2 text-sm bg-background border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary",children:[e.jsx("option",{value:"",children:"Pilih Brand"}),y.map(t=>e.jsx("option",{value:t,children:t},t))]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm mb-1.5",children:["Kategori ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:a.category,onChange:t=>i({...a,category:t.target.value}),required:!0,className:"w-full px-3 py-2 text-sm bg-background border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary",children:[e.jsx("option",{value:"",children:"Pilih Kategori"}),o.map(t=>e.jsx("option",{value:t,children:t},t))]})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm mb-1.5",children:["Deskripsi ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("textarea",{value:a.description,onChange:t=>i({...a,description:t.target.value}),placeholder:"Deskripsi project...",rows:3,required:!0,className:"w-full px-3 py-2 text-sm bg-background border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary resize-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm mb-1.5",children:"Gambar Project"}),e.jsx(D,{value:a.image_url,onChange:t=>i({...a,image_url:t})})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm mb-1.5",children:["Status ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer text-sm",children:[e.jsx("input",{type:"radio",name:"status",value:"ongoing",checked:a.status==="ongoing",onChange:t=>i({...a,status:t.target.value}),className:"w-4 h-4"}),e.jsx("span",{children:"Ongoing"})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer text-sm",children:[e.jsx("input",{type:"radio",name:"status",value:"completed",checked:a.status==="completed",onChange:t=>i({...a,status:t.target.value}),className:"w-4 h-4"}),e.jsx("span",{children:"Completed"})]})]})]})]}),e.jsxs("div",{className:"flex gap-2 p-4 border-t border-border bg-muted/30",children:[e.jsx("button",{type:"button",onClick:l,className:"flex-1 px-4 py-2 text-sm bg-muted hover:bg-muted/80 rounded-lg transition-colors",children:"Batal"}),e.jsx("button",{type:"submit",disabled:h,className:"flex-1 px-4 py-2 text-sm bg-primary text-white rounded-lg hover:bg-primary/90 transition-colors disabled:opacity-50",children:h?"Menyimpan...":d==="create"?"Tambah":"Simpan"})]})]})]})})]})})}function U(){const u=S(),[l,j]=m.useState(""),[r,d]=m.useState("all"),{projects:a,loading:i,createProject:h,updateProject:p,deleteProject:f,refetch:y}=_({autoFetch:!0}),[o,t]=m.useState({isOpen:!1,mode:"create",project:null}),g=()=>{t({isOpen:!0,mode:"create",project:null})},v=s=>{t({isOpen:!0,mode:"edit",project:s})},w=async s=>{if(confirm("Apakah Anda yakin ingin menghapus project ini?"))try{await f(s),x.success("Project berhasil dihapus")}catch(n){x.error("Gagal menghapus project"),console.error(n)}},k=async s=>{try{o.mode==="create"?(await h(s),x.success("Project berhasil ditambahkan")):o.project&&(await p(o.project.id,s),x.success("Project berhasil diupdate")),y()}catch(n){throw x.error("Terjadi kesalahan"),console.error(n),n}},b=a.filter(s=>{const n=s.title.toLowerCase().includes(l.toLowerCase())||s.brand.toLowerCase().includes(l.toLowerCase())||s.category.toLowerCase().includes(l.toLowerCase()),C=r==="all"||s.brand===r;return n&&C}),P=["all",...new Set(a.map(s=>s.brand))];return e.jsxs("div",{className:"min-h-screen bg-muted/30 pt-20",children:[e.jsxs("div",{className:"max-w-7xl mx-auto p-4 md:p-6 lg:p-8",children:[e.jsxs(c.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"mb-6",children:[e.jsxs("button",{onClick:()=>u("/admin"),className:"flex items-center gap-2 text-muted-foreground hover:text-foreground mb-4 transition-colors text-sm",children:[e.jsx(A,{className:"h-4 w-4"}),e.jsx("span",{children:"Kembali"})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl md:text-3xl font-bold mb-1",children:"Projects Management"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Kelola portfolio dan project showcase"})]}),e.jsxs("button",{onClick:g,className:"px-4 py-2 md:px-6 md:py-3 bg-primary text-white rounded-xl hover:bg-primary/90 transition-all flex items-center justify-center gap-2 shadow-lg hover:shadow-xl text-sm md:text-base",children:[e.jsx(B,{className:"h-4 w-4 md:h-5 md:w-5"}),e.jsx("span",{children:"Tambah Project"})]})]})]}),e.jsx(c.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"grid grid-cols-2 md:grid-cols-4 gap-3 md:gap-4 mb-6",children:[{label:"Total Projects",value:a.length,color:"text-foreground"},{label:"Completed",value:a.filter(s=>s.status==="completed").length,color:"text-green-600"},{label:"Ongoing",value:a.filter(s=>s.status==="ongoing").length,color:"text-amber-600"},{label:"Total Views",value:a.reduce((s,n)=>s+(n.views||0),0),color:"text-blue-600"}].map((s,n)=>e.jsxs("div",{className:"bg-card rounded-xl p-4 md:p-5 border border-border",children:[e.jsx("p",{className:"text-xs md:text-sm text-muted-foreground mb-1",children:s.label}),e.jsx("h3",{className:`text-xl md:text-2xl font-bold ${s.color}`,children:s.value})]},n))}),e.jsx(c.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"bg-card rounded-xl border border-border p-4 mb-4",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-3",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(L,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx("input",{type:"text",value:l,onChange:s=>j(s.target.value),placeholder:"Cari project...",className:"w-full pl-10 pr-4 py-2 text-sm bg-background border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary"})]}),e.jsx("select",{value:r,onChange:s=>d(s.target.value),className:"px-4 py-2 text-sm bg-background border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary",children:P.map(s=>e.jsx("option",{value:s,children:s==="all"?"Semua Brand":s},s))})]})}),e.jsxs(c.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"bg-card rounded-xl border border-border overflow-hidden",children:[i?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"inline-block w-8 h-8 border-4 border-primary/30 border-t-primary rounded-full animate-spin mb-4"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Memuat projects..."})]}):b.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(N,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:l||r!=="all"?"Tidak ada project yang ditemukan":"Belum ada project"}),!l&&r==="all"&&e.jsx("button",{onClick:g,className:"px-6 py-2 bg-primary text-white rounded-lg hover:bg-primary/90 text-sm",children:"Tambah Project Pertama"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-muted/50",children:e.jsxs("tr",{className:"text-left text-xs uppercase tracking-wider text-muted-foreground",children:[e.jsx("th",{className:"px-4 py-3 font-medium",children:"Project"}),e.jsx("th",{className:"px-4 py-3 font-medium hidden md:table-cell",children:"Brand"}),e.jsx("th",{className:"px-4 py-3 font-medium hidden lg:table-cell",children:"Kategori"}),e.jsx("th",{className:"px-4 py-3 font-medium",children:"Status"}),e.jsx("th",{className:"px-4 py-3 font-medium hidden lg:table-cell",children:"Views"}),e.jsx("th",{className:"px-4 py-3 font-medium text-right",children:"Aksi"})]})}),e.jsx("tbody",{className:"divide-y divide-border",children:b.map(s=>e.jsxs("tr",{className:"hover:bg-muted/30 transition-colors",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-16 h-12 rounded-lg overflow-hidden bg-muted flex-shrink-0 hidden sm:block",children:s.image_url?e.jsx("img",{src:s.image_url,alt:s.title,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(N,{className:"h-6 w-6 text-muted-foreground"})})}),e.jsxs("div",{className:"min-w-0 max-w-xs",children:[e.jsx("p",{className:"font-medium text-sm line-clamp-1",children:s.title}),e.jsx("p",{className:"text-xs text-muted-foreground line-clamp-1",children:s.description}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1 md:hidden",children:s.brand})]})]})}),e.jsx("td",{className:"px-4 py-3 text-sm hidden md:table-cell",children:e.jsx("span",{className:"px-2 py-1 bg-primary/10 text-primary rounded text-xs font-medium",children:s.brand})}),e.jsx("td",{className:"px-4 py-3 text-sm text-muted-foreground hidden lg:table-cell",children:s.category}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded text-xs font-medium ${s.status==="completed"?"bg-green-100 dark:bg-green-950/30 text-green-700 dark:text-green-400":"bg-amber-100 dark:bg-amber-950/30 text-amber-700 dark:text-amber-400"}`,children:s.status==="completed"?"Selesai":"Ongoing"})}),e.jsx("td",{className:"px-4 py-3 text-sm text-muted-foreground hidden lg:table-cell",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(M,{className:"h-3 w-3"}),e.jsx("span",{children:s.views||0})]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx("button",{onClick:()=>v(s),className:"p-2 hover:bg-muted rounded-lg transition-colors",title:"Edit",children:e.jsx(T,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>w(s.id),className:"p-2 hover:bg-red-50 dark:hover:bg-red-950/20 text-red-600 rounded-lg transition-colors",title:"Hapus",children:e.jsx(E,{className:"h-4 w-4"})})]})})]},s.id))})]})}),b.length>0&&e.jsx("div",{className:"px-4 py-3 border-t border-border bg-muted/30",children:e.jsxs("p",{className:"text-xs text-muted-foreground text-center",children:["Menampilkan ",b.length," dari ",a.length," projects"]})})]})]}),e.jsx(R,{isOpen:o.isOpen,onClose:()=>t({isOpen:!1,mode:"create",project:null}),onSubmit:k,project:o.project,mode:o.mode})]})}export{U as ProjectsManagement};
