import{j as e}from"./radix-ui-core-CVbt7vjv.js";import{c as m,h as T}from"./react-vendor-CF8XAmli.js";import{X as L,a0 as M,a1 as D,s as O,Q as q,u as A,a3 as E,a4 as F,t as h}from"./other-ui-8Y7Mtx8D.js";import{u as G}from"./useStore-D_VPXoPI.js";import{I}from"./ImageUploader-D3ZS0H5I.js";import{A as K,m as x}from"./index-SAJX4igD.js";import"./store-CtWTswGK.js";import"./supabase-vendor-D5o4eRXO.js";import"./motion-vendor-gX53-bda.js";function R({isOpen:p,onClose:n,onSubmit:f,product:t,mode:u}){const[r,l]=m.useState({name:"",description:"",price:0,discount_price:0,images:[],category:"",condition:"Like New",stock:1,stock_status:"available",is_rooted:!1,location:"Jakarta"}),[d,g]=m.useState(!1);m.useEffect(()=>{l(u==="edit"&&t?{name:t.name,description:t.description,price:t.price,discount_price:t.discount_price||0,images:t.images||[],category:t.category,condition:t.condition,stock:t.stock,stock_status:t.stock_status||"available",is_rooted:t.is_rooted,location:t.location}:{name:"",description:"",price:0,discount_price:0,images:[],category:"",condition:"Like New",stock:1,stock_status:"available",is_rooted:!1,location:"Jakarta"})},[u,t,p]);const j=async a=>{a.preventDefault(),g(!0);try{await f(r),n()}catch(o){console.error("Error submitting product:",o)}finally{g(!1)}},y=["Samsung","Google","Xiaomi","OnePlus","Realme","Asus","Sony","Lainnya"],N=["Like New","Excellent","Good"];return e.jsx(K,{children:p&&e.jsxs(e.Fragment,{children:[e.jsx(x.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n,className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50"}),e.jsx("div",{className:"fixed inset-0 flex items-center justify-center z-50 p-4",children:e.jsxs(x.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},className:"bg-card rounded-xl shadow-2xl border border-border w-full max-w-2xl max-h-[90vh] overflow-hidden flex flex-col",onClick:a=>a.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-border flex-shrink-0",children:[e.jsx("h3",{children:u==="create"?"Tambah Produk":"Edit Produk"}),e.jsx("button",{onClick:n,className:"p-1.5 hover:bg-muted rounded-lg transition-colors",children:e.jsx(L,{className:"h-4 w-4"})})]}),e.jsxs("form",{onSubmit:j,className:"overflow-y-auto flex-1",children:[e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm mb-1.5",children:["Nama Produk ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:r.name,onChange:a=>l({...r,name:a.target.value}),placeholder:"Samsung Galaxy S21 Ultra 5G",required:!0,className:"w-full px-3 py-2 text-sm bg-background border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm mb-1.5",children:["Brand/Kategori ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:r.category,onChange:a=>l({...r,category:a.target.value}),required:!0,className:"w-full px-3 py-2 text-sm bg-background border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary",children:[e.jsx("option",{value:"",children:"Pilih Brand"}),y.map(a=>e.jsx("option",{value:a,children:a},a))]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm mb-1.5",children:["Kondisi ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("select",{value:r.condition,onChange:a=>l({...r,condition:a.target.value}),required:!0,className:"w-full px-3 py-2 text-sm bg-background border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary",children:N.map(a=>e.jsx("option",{value:a,children:a},a))})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm mb-1.5",children:["Harga (Rp) ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"number",value:r.price,onChange:a=>l({...r,price:Number(a.target.value)}),required:!0,min:"0",className:"w-full px-3 py-2 text-sm bg-background border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm mb-1.5",children:"Harga Diskon (Opsional)"}),e.jsx("input",{type:"number",value:r.discount_price,onChange:a=>l({...r,discount_price:Number(a.target.value)}),min:"0",className:"w-full px-3 py-2 text-sm bg-background border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm mb-1.5",children:["Stok ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"number",value:r.stock,onChange:a=>{const o=Number(a.target.value);let c="available";o===0?c="sold_out":o<=3&&(c="low_stock"),l({...r,stock:o,stock_status:c})},required:!0,min:"0",className:"w-full px-3 py-2 text-sm bg-background border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm mb-1.5",children:"Status Stok"}),e.jsxs("select",{value:r.stock_status,onChange:a=>l({...r,stock_status:a.target.value}),className:"w-full px-3 py-2 text-sm bg-background border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary",children:[e.jsx("option",{value:"available",children:"Tersedia"}),e.jsx("option",{value:"low_stock",children:"Stok Terbatas"}),e.jsx("option",{value:"sold_out",children:"Sold Out"})]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Otomatis berubah saat stok diubah"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm mb-1.5",children:["Lokasi ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:r.location,onChange:a=>l({...r,location:a.target.value}),required:!0,placeholder:"Jakarta",className:"w-full px-3 py-2 text-sm bg-background border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm mb-1.5",children:["Deskripsi ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("textarea",{value:r.description,onChange:a=>l({...r,description:a.target.value}),placeholder:"Deskripsi lengkap produk...",rows:4,required:!0,className:"w-full px-3 py-2 text-sm bg-background border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary resize-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm mb-1.5",children:"Gambar Produk"}),e.jsx(I,{value:r.images[0]||"",onChange:a=>l({...r,images:a?[a]:[]}),description:"Upload gambar utama produk"})]}),e.jsx("div",{children:e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer text-sm",children:[e.jsx("input",{type:"checkbox",checked:r.is_rooted,onChange:a=>l({...r,is_rooted:a.target.checked}),className:"w-4 h-4 rounded border-gray-300 text-primary focus:ring-primary"}),e.jsx("span",{children:"Sudah Root / Custom ROM?"})]})})]}),e.jsxs("div",{className:"flex gap-2 p-4 border-t border-border bg-muted/30",children:[e.jsx("button",{type:"button",onClick:n,className:"flex-1 px-4 py-2 text-sm bg-muted hover:bg-muted/80 rounded-lg transition-colors",children:"Batal"}),e.jsx("button",{type:"submit",disabled:d,className:"flex-1 px-4 py-2 text-sm bg-primary text-white rounded-lg hover:bg-primary/90 transition-colors disabled:opacity-50",children:d?"Menyimpan...":u==="create"?"Tambah Produk":"Simpan Perubahan"})]})]})]})})]})})}function W(){const p=T(),[n,f]=m.useState(""),[t,u]=m.useState("all"),[r,l]=m.useState("table"),{products:d,loading:g,createProduct:j,updateProduct:y,deleteProduct:N,refetch:a}=G({autoFetch:!0}),[o,c]=m.useState({isOpen:!1,mode:"create",product:null}),v=()=>{c({isOpen:!0,mode:"create",product:null})},w=s=>{c({isOpen:!0,mode:"edit",product:s})},S=async s=>{if(confirm("Apakah Anda yakin ingin menghapus produk ini?"))try{await N(s),h.success("Produk berhasil dihapus")}catch(i){h.error("Gagal menghapus produk"),console.error(i)}},P=async s=>{try{o.mode==="create"?(await j(s),h.success("Produk berhasil ditambahkan")):o.product&&(await y(o.product.id,s),h.success("Produk berhasil diupdate")),a()}catch(i){throw h.error("Terjadi kesalahan"),console.error(i),i}},b=d.filter(s=>{const i=s.name.toLowerCase().includes(n.toLowerCase())||s.category.toLowerCase().includes(n.toLowerCase()),_=t==="all"||s.category===t;return i&&_}),C=["all",...new Set(d.map(s=>s.category))],k=s=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(s);return e.jsxs("div",{className:"min-h-screen bg-muted/30 pt-20",children:[e.jsxs("div",{className:"max-w-7xl mx-auto p-4 md:p-6 lg:p-8",children:[e.jsxs(x.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"mb-6",children:[e.jsxs("button",{onClick:()=>p("/admin"),className:"flex items-center gap-2 text-muted-foreground hover:text-foreground mb-4 transition-colors text-sm",children:[e.jsx(M,{className:"h-4 w-4"}),e.jsx("span",{children:"Kembali"})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl md:text-3xl font-bold mb-1",children:"Store Management"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Kelola katalog produk dan stok barang"})]}),e.jsxs("button",{onClick:v,className:"px-4 py-2 md:px-6 md:py-3 bg-primary text-white rounded-xl hover:bg-primary/90 transition-all flex items-center justify-center gap-2 shadow-lg hover:shadow-xl text-sm md:text-base",children:[e.jsx(D,{className:"h-4 w-4 md:h-5 md:w-5"}),e.jsx("span",{children:"Tambah Produk"})]})]})]}),e.jsx(x.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"grid grid-cols-2 md:grid-cols-4 gap-3 md:gap-4 mb-6",children:[{label:"Total Produk",value:d.length,color:"text-foreground"},{label:"Total Stock",value:d.reduce((s,i)=>s+(i.stock||0),0),color:"text-blue-600"},{label:"Low Stock",value:d.filter(s=>s.stock<3).length,color:"text-amber-600"},{label:"Terjual",value:d.reduce((s,i)=>s+(i.sold_count||0),0),color:"text-green-600"}].map((s,i)=>e.jsxs("div",{className:"bg-card rounded-xl p-4 md:p-5 border border-border",children:[e.jsx("p",{className:"text-xs md:text-sm text-muted-foreground mb-1",children:s.label}),e.jsx("h3",{className:`text-xl md:text-2xl font-bold ${s.color}`,children:s.value})]},i))}),e.jsx(x.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"bg-card rounded-xl border border-border p-4 mb-4",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-3",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(O,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx("input",{type:"text",value:n,onChange:s=>f(s.target.value),placeholder:"Cari produk...",className:"w-full pl-10 pr-4 py-2 text-sm bg-background border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary"})]}),e.jsx("select",{value:t,onChange:s=>u(s.target.value),className:"px-4 py-2 text-sm bg-background border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary",children:C.map(s=>e.jsx("option",{value:s,children:s==="all"?"Semua Kategori":s},s))})]})}),e.jsxs(x.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"bg-card rounded-xl border border-border overflow-hidden",children:[g?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"inline-block w-8 h-8 border-4 border-primary/30 border-t-primary rounded-full animate-spin mb-4"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Memuat produk..."})]}):b.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(q,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:n||t!=="all"?"Tidak ada produk yang ditemukan":"Belum ada produk"}),!n&&t==="all"&&e.jsx("button",{onClick:v,className:"px-6 py-2 bg-primary text-white rounded-lg hover:bg-primary/90 text-sm",children:"Tambah Produk Pertama"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-muted/50",children:e.jsxs("tr",{className:"text-left text-xs uppercase tracking-wider text-muted-foreground",children:[e.jsx("th",{className:"px-4 py-3 font-medium",children:"Produk"}),e.jsx("th",{className:"px-4 py-3 font-medium hidden md:table-cell",children:"Kategori"}),e.jsx("th",{className:"px-4 py-3 font-medium",children:"Harga"}),e.jsx("th",{className:"px-4 py-3 font-medium hidden lg:table-cell",children:"Stock"}),e.jsx("th",{className:"px-4 py-3 font-medium hidden lg:table-cell",children:"Terjual"}),e.jsx("th",{className:"px-4 py-3 font-medium text-right",children:"Aksi"})]})}),e.jsx("tbody",{className:"divide-y divide-border",children:b.map(s=>e.jsxs("tr",{className:"hover:bg-muted/30 transition-colors",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-lg overflow-hidden bg-muted flex-shrink-0",children:s.images&&s.images.length>0?e.jsx("img",{src:s.images[0],alt:s.name,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(A,{className:"h-6 w-6 text-muted-foreground"})})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"font-medium text-sm truncate",children:s.name}),e.jsx("p",{className:"text-xs text-muted-foreground md:hidden",children:s.category})]})]})}),e.jsx("td",{className:"px-4 py-3 text-sm hidden md:table-cell",children:e.jsx("span",{className:"px-2 py-1 bg-secondary/10 text-secondary rounded text-xs",children:s.category})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("div",{children:s.discount_price&&s.discount_price>0?e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-sm font-medium text-green-600",children:k(s.discount_price)}),e.jsx("p",{className:"text-xs text-muted-foreground line-through",children:k(s.price)})]}):e.jsx("p",{className:"text-sm font-medium",children:k(s.price)})})}),e.jsx("td",{className:"px-4 py-3 hidden lg:table-cell",children:e.jsxs("span",{className:`inline-flex items-center px-2 py-1 rounded text-xs font-medium ${s.stock>5?"bg-green-100 dark:bg-green-950/30 text-green-700 dark:text-green-400":s.stock>0?"bg-amber-100 dark:bg-amber-950/30 text-amber-700 dark:text-amber-400":"bg-red-100 dark:bg-red-950/30 text-red-700 dark:text-red-400"}`,children:[s.stock," unit"]})}),e.jsx("td",{className:"px-4 py-3 text-sm text-muted-foreground hidden lg:table-cell",children:s.sold_count||0}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx("button",{onClick:()=>w(s),className:"p-2 hover:bg-muted rounded-lg transition-colors",title:"Edit",children:e.jsx(E,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>S(s.id),className:"p-2 hover:bg-red-50 dark:hover:bg-red-950/20 text-red-600 rounded-lg transition-colors",title:"Hapus",children:e.jsx(F,{className:"h-4 w-4"})})]})})]},s.id))})]})}),b.length>0&&e.jsx("div",{className:"px-4 py-3 border-t border-border bg-muted/30",children:e.jsxs("p",{className:"text-xs text-muted-foreground text-center",children:["Menampilkan ",b.length," dari ",d.length," produk"]})})]})]}),e.jsx(R,{isOpen:o.isOpen,onClose:()=>c({isOpen:!1,mode:"create",product:null}),onSubmit:P,product:o.product,mode:o.mode})]})}export{W as StoreManagement};
