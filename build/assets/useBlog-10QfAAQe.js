import{c as l}from"./react-vendor-CF8XAmli.js";import{s as i,i as S}from"./index-B7e89noG.js";const d={async getAll(e){let t=i.from("blog_posts").select("*").order("published_at",{ascending:!1,nullsFirst:!1}).order("created_at",{ascending:!1});e?.category&&(t=t.eq("category",e.category)),e?.status?t=t.eq("status",e.status):t=t.eq("status","published"),e?.limit&&(t=t.limit(e.limit));const{data:a,error:s}=await t;if(s)throw s;return a},async getById(e){const{data:t,error:a}=await i.from("blog_posts").select("*").eq("id",e).maybeSingle();if(a)throw a;if(!t)throw new Error("Blog post not found");return t},async getBySlug(e){const{data:t,error:a}=await i.from("blog_posts").select("*").eq("slug",e).maybeSingle();if(a)throw a;if(!t)throw new Error("Blog post not found");return t},async create(e){const{data:t,error:a}=await i.from("blog_posts").insert([e]).select().maybeSingle();if(a)throw a;if(!t)throw new Error("Failed to create blog post (check RLS policies)");return t},async update(e,t){const{data:a,error:s}=await i.from("blog_posts").update({...t,updated_at:new Date().toISOString()}).eq("id",e).select().maybeSingle();if(s)throw s;if(!a)throw new Error("Blog post not found or permission denied (check RLS policies)");return a},async delete(e){const{error:t}=await i.from("blog_posts").delete().eq("id",e);if(t)throw t},async incrementViews(e){const{error:t}=await i.rpc("increment_blog_views",{blog_id:e});if(t)throw t},async getTotalViews(){const{data:e,error:t}=await i.from("blog_posts").select("views");if(t)throw t;return e.reduce((a,s)=>a+(s.views||0),0)},async getRecent(e=6){return this.getAll({status:"published",limit:e})}},R=[{id:"1",title:"Panduan Lengkap Root Android 2024",slug:"panduan-lengkap-root-android-2024",excerpt:"Pelajari cara root Android dengan aman dan mudah menggunakan Magisk terbaru.",content:"Root Android adalah proses mendapatkan akses superuser...",category:"Tutorial",image_url:"https://images.unsplash.com/photo-1556656793-08538906a9f8?w=800",author:"Admin",status:"published",views:1234,created_at:new Date().toISOString(),updated_at:new Date().toISOString(),published_at:new Date().toISOString()},{id:"2",title:"Custom ROM Terbaik 2024",slug:"custom-rom-terbaik-2024",excerpt:"Daftar custom ROM Android terbaik tahun 2024 dengan fitur lengkap.",content:"Custom ROM memberikan pengalaman Android yang lebih baik...",category:"Review",image_url:"https://images.unsplash.com/photo-1607252650355-f7fd0460ccdb?w=800",author:"Admin",status:"published",views:876,created_at:new Date().toISOString(),updated_at:new Date().toISOString(),published_at:new Date().toISOString()}];function q(e={}){const[t,a]=l.useState([]),[s,u]=l.useState(!0),[b,c]=l.useState(null),{category:g,status:p,limit:w,autoFetch:h=!0}=e,m=async()=>{try{u(!0),c(null);const r=await d.getAll({category:g,status:p,limit:w});a(r)}catch(r){c(r),console.error("Error fetching blog posts:",r),a([])}finally{u(!1)}};return l.useEffect(()=>{h&&m()},[g,p,w,h]),{posts:t,loading:s,error:b,refetch:m,createPost:async r=>{try{const o=await d.create(r);return a(n=>[o,...n]),o}catch(o){throw c(o),o}},updatePost:async(r,o)=>{try{const n=await d.update(r,o);return a(y=>y.map(f=>f.id===r?n:f)),n}catch(n){throw c(n),n}},deletePost:async r=>{try{await d.delete(r),a(o=>o.filter(n=>n.id!==r))}catch(o){throw c(o),o}}}}export{d as b,q as u};
