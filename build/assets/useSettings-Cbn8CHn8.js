import{c as u}from"./react-vendor-CF8XAmli.js";import{s as l}from"./index-B7e89noG.js";import{t as w}from"./other-ui-8Y7Mtx8D.js";const p={getAll:async()=>{const{data:t,error:e}=await l.from("website_settings").select("*").order("key");if(e)throw e;return t},getByGroup:async t=>{const{data:e,error:s}=await l.from("website_settings").select("*").eq("group_name",t).order("key");if(s)throw s;return e},update:async(t,e)=>{const{data:s,error:n}=await l.from("website_settings").update({value:e,updated_at:new Date().toISOString()}).eq("key",t).select().maybeSingle();if(n)throw n;return s},updateMultiple:async t=>{const e=t.map(a=>l.from("website_settings").update({value:a.value,updated_at:new Date().toISOString()}).eq("key",a.key)),n=(await Promise.all(e)).filter(a=>a.error).map(a=>a.error);if(n.length>0)throw n[0];return!0}};function k(t){const[e,s]=u.useState([]),[n,a]=u.useState(!0),[d,f]=u.useState(null),g=u.useCallback(async()=>{try{a(!0);let r;t?r=await p.getByGroup(t):r=await p.getAll(),s(r||[])}catch(r){console.error("Error fetching settings:",r),f(r)}finally{a(!1)}},[t]);return u.useEffect(()=>{g()},[g]),{settings:e,loading:n,error:d,updateSetting:async(r,c)=>{try{return await p.update(r,c),s(o=>o.map(i=>i.key===r?{...i,value:c}:i)),!0}catch(o){throw console.error("Error updating setting:",o),w.error("Gagal mengupdate pengaturan"),o}},getSettingValue:(r,c="")=>{const o=e.find(i=>i.key===r);return o?o.value:c},refetch:g}}export{k as u};
